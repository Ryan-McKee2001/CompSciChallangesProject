<!DOCTYPE HTML>

<html>
	<head>
		<title> </title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.dropotron.min.js"></script>
		<script src="js/jquery.scrollgress.min.js"></script>
		<script src="js/jquery.scrolly.min.js"></script>
		<script src="js/jquery.slidertron.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie/v9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<header id="header" class="skel-layers-fixed">
			<h1><a href="index.html">Computer Science Challanges:<span> How to guide</span></a></h1>				
			</header>

		<!-- Main -->
			<section id="main" class="wrapper style1">
				<header class="major">
					<h2>Getting started with ammo.js/three.js</h2>
				</header>
				<div class="container">
						
			<!-- Content -->
				<section id="content">
					<h2 align="center">
						<strong><u>How to get Started with ammo.js/three.js</u></strong>
					</h2>		
					<p>
						<strong><u>Getting started with three.js and ammo.js</u></strong>
					</p>
					<p>
						<strong><u>Introduction</u></strong>
					</p>
					<p><strong>
						Welcome to my guide on ammo.js and three.js this guide aims to give you 
						the knowledge on the fundamentals of using these libraries and will show 
						you some coding examples of these concepts in practice.
					</strong></p>
					<p>
						<strong><u>What are three.js and ammo.js?</u></strong>
					</p>
					<p><strong>
						Ammo and three.js are both JavaScript libraries, three.js is a graphics engine 
						that allows you to create and display animated 2d graphics in a web browser using webGL, 
						this is a great library with many users and great projects supporting it so it is not 
						hard to learn using the resources available one of these resources include the three.js 
						website ( <a href = "https://threejs.org/">Three.js website</a> ) which contains several examples of what can be done with the 
						library and has documentation explaining all the code and what it does. Ammo.js is a physics 
						engine that allows you to create a physics world that can be used in conjunction with a graphics 
						engine to create graphical physics simulations. This library is a port of the popular c and c++ 
						bullet physics engine, therefore, it is a niche library with very few guides and projects using 
						it therefore it can be hard to learn.
					</strong></p>
					<p>
						<strong>
								There is 4 main part of ammo.js concepts that you should be aware
								of to get used of this engine these are:
						</strong>
					</p>
					<ul>
						<li>Rigid Bodies</li>
						<li>Soft Bodies</li>
						<li>Constraints</li>
						<li>Collision detection and filtering</li>
					</ul>
					<p>
						<strong><u>Rigid bodies</u></strong>
					</p>
					<p><strong>
						Bodies in ammo.js are called collision objects or more commonly rigid bodies. Rigid bodies are the objects 
						in the simulation which move, collide, and have mass, and can have impulses applied to them.
					</strong></p>
					<a href="#" class="image fit"><img src="images/rigidBodyExample.png.crdownload" alt="" /></a>
					<p><strong>
						There are three types of rigid bodies and many-body shapes can be
						implemented in ammo.js. The three types of ammo.js bodies are:
					</strong></p>
					<ul>
						<li>
							Static Rigid bodies – These bodies have a fixed position throughout the physics simulation and cannot be moved 
							when defining these bodies they have a mass of 0 applied to them.
						</li>
						<li>
							Kinematic Rigid bodies – These bodies are not affected by the physics of the Ammo.js world but are can be animated 
							during the physics simulation, These bodies are similar to the static rigid bodies in that they have a mass of 0, but 
							unlike the static rigid bodies, we add the bodies to the rigid bodies array we typically define globally at the start 
							of our program script to allow the positions of it and its three.js counterpart to be changed in the worlds as it is animated.
						</li>
						<li>
							Dynamic rigid bodies – These are the most intensive rigid body type in ammo.js, these bodies are fully affected by the physics of the world
							and every body is based on these.
						</li>
					</ul>
					<p>
						<strong><u>Soft bodies</u></strong>
					</p>
					<p><strong>
						Soft bodies are defined as bodies in computer graphics that visually and
						realistically represent the motion and properties of deformable objects
						while being able to some extent retain their shape, these bodies can
						represent real-life objects balloons, or clothes.
					</strong></p>
					<p>
						<strong><u>Constraints</u></strong>
					</p>
					<p><strong>
						Constraints can be thought of as joints that would be used in real life to
						connect multiple objects. There are multiple types of constraints in
						ammo.js to carry out different functions:
					</strong></p>
					<ul>
						<li>
							Point–to–point constraints - Point-to-point constraints limit the translation 
							of two pivot points of rigid bodies to match the world space. Using this constraint, 
							you can create a chain of rigid bodies. This constraint can be useful for creating 
							something like a robotic arm or in the case of my structures project a plank of wood 
							using several rigid bodies in columns and rows.
						</li>
						<li>
							Hinge constraints - Hinge constraints are joints that restrict rotation around the pivot of 
							two bodies to only one axis, therefore this axis could be useful for creating something like a door. 
							Or even flaps on an airplane model as this constraint also allows the user to specify the limits
							and motor of the hinge.
						</li>
						<li>
							Slider constraint - The slider constraint allows a body to rotate around one axis and translate 
							along that axis. This constraint would be useful for creating something like a piston.
						</li>
						<li>
							Cone twist constraints - This cone constraint is a special version of the point-to-point constraint 
							that adds cone and twist axis limits. The axis for this constraint serves as a twist axis. This constraint 
							is useful for creating something like a ragdoll.
						</li>
					</ul>
				

					<p>
						<strong><u>Collision detection</u></strong>
					</p>
					<p><strong>
						Collision detection in ammo.js is a concept that allows for the collision and interaction between objects, 
						four main concepts aid with collision detection which allows you to show how objects interact in a world.
					</strong></p>
					<ul>
						<li>Contact Manifold check</li>
						<li>Contact test</li>
						<li>Contact pair test</li>
						<li>Ghost objects</li>
					</ul>
					<p><strong>
						To understand each of these I suggest you check out this tutorial:
						<a
							target="_blank"
							href="https://medium.com/@bluemagnificent/collision-detection-in-javascript-3d-physics-using-ammo-js-and-three-js-31a5569291ef"
						>
							https://medium.com/@bluemagnificent/collision-detection-in-javascript-3d-physics-using-ammo-js-and-three-js-31a5569291ef
						</a>
						. As collision detection is a big topic and 
						the basics will only be convered in this tutorial.
					</strong></p>
					<a href="#" class="image fit"><img src="images/collision detection.jpg" alt="" /></a>
					<p>
						<strong><u>Getting started</u></strong>
					</p>
					<p>
						<strong>
							Before we start programming some of these concepts you need to first set up your workspace to do this you will need to install ammo.js 
							and three.js from this link:   when you are done that you can create a folder with whatever project name you want and inside that folder 
							create an index file and a js folder containing both the ammo.js/ three.js files, for a more in-depth tutorial on setting up your workspace
							 you can use this link: 
						</strong>
						<a
							target="_blank"
							href="https://github.com/mattr862/Ammo.js-Three.js/blob/master/Setting%20up%20ammo.js%20Three.js.pdf"
						>
							<strong>
								https://github.com/mattr862/Ammo.js-Three.js/blob/master/Setting%20up%20ammo.js%20Three.js.pdf
							</strong>
						</a>
						<strong>.</strong>
					</p>
					<p>
						<strong>
							Now that you have set up your folder you will need to also have an IDE that supports javascript and HTML if you do not have this already I 
							suggest you install visual studio code which is what will be used during this how-to guide: <a href = "https://code.visualstudio.com/download">vs code download</a>.
						</strong>
					</p>
					<p>
						<strong>
							Now you are ready to start programming, with your index.html file open
							in the IDE you should now do the “! Tab” shortcut at the top of the
							document to auto-create your HTML page. Now you will want to import the
							libraries you will be using for this body by using the script tag in
							body and src from the root of the folder to “js/ammo.js” and
							“js/three.js” and create another script tag that will contain your
							JavaScript code for this tutorial.
						</strong>
					</p>
					<p>
						<strong>Your code should look like this:</strong>
					</p>
					<figure>
						<pre>
						  <code contenteditable spellcheck="false">  
								<!DOCTYPE html>
								<html lang="en">
								<head>
									<meta charset="UTF-8">
									<meta name="viewport" content="width=device-width, initial-scale=1.0">
									<title>Setting up world</title>
								</head>
								<body>
									<script src="js/three.js"></script>
									<script src="js/ammo.js"></script>
								
									<script>
									</script>
								</body>
								</html>
							}  
						  </code>
						</pre>
					  </figure>
					<h3>
						<strong>
							In your script tag, you will also want to create an Init function (
							init short for initiate ) which will contain all the main function
							calls and enter the statement Ammo().then( Init ); which will initiate
							ammo.
						</strong>
					</h3>
					<p><strong>
						After this you need to declare the global variables for the program, so at
						the top of the script we we enter the following code:
					</strong></p>
					<figure>
						<pre>
						  <code contenteditable spellcheck="false">  
							//variable declaration
							let physicsWorld, controls, scene, camera, renderer; //three.js variables
							let rigidBodies = [];  // ammo.js variables
							}  
						  </code>
						</pre>
					  </figure>
					<h3>
						<strong><u>Declaring variables and setting up graphics</u></strong>
					</h3>
					<p>
						<strong>
							Before creating the physics world, we need to first create the graphics
							by creating a world three.js which will be what you see on the browser,
							To do this we define a setUpGraphics function which instantiates the
							three main attributes for our three.js world: "the camera, renderer,
							and scene". We will define all these attributes at the beginning of the
							script which the world will be based on so their values can be accessed
							globally. There are many other attributes you can add like lighting and
							so on but we will not be covering these in this tutorial. In this
							function, we will instantiate also a clock attribute which will be used
							later when we begin working with ammo.js.
						</strong>
					</p>
					<figure>
						<pre>
						  <code contenteditable spellcheck="false">  
							function setupGraphics()
							{
								//create clock for timing
								clock = new THREE.Clock();
					
								//create the scene
								scene = new THREE.Scene();
								scene.background = new THREE.Color( 0xbfd1e5 );
					
								//create camera
								camera = new THREE.PerspectiveCamera( 17, window.innerWidth / window.innerHeight, 0.2, 5000 );
								camera.position.set( 50, 180, -170 );
								camera.lookAt(new THREE.Vector3(0, 0, 0));
					
								//Add hemisphere light
								let hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 0.1 );
								hemiLight.color.setHSL( 0.6, 0.6, 0.6 );
								hemiLight.groundColor.setHSL( 0.1, 1, 0.4 );
								hemiLight.position.set( 0, 50, 0 );
								scene.add( hemiLight );
					
								//Add directional light
								let dirLight = new THREE.DirectionalLight( 0xffffff , 1);
								dirLight.color.setHSL( 0.1, 1, 0.95 );
								dirLight.position.set( -1, 1.75, 1 );
								dirLight.position.multiplyScalar( 100 );
								scene.add( dirLight );
					
								dirLight.castShadow = true;
					
								dirLight.shadow.mapSize.width = 2048;
								dirLight.shadow.mapSize.height = 2048;
					
								let d = 50;
					
								dirLight.shadow.camera.left = -d;
								dirLight.shadow.camera.right = d;
								dirLight.shadow.camera.top = d;
								dirLight.shadow.camera.bottom = -d;
								dirLight.shadow.camera.far = 13500;
					
								//Setup the renderer
								renderer = new THREE.WebGLRenderer( { antialias: true } );
								renderer.setClearColor( 0xbfd1e5 );
								renderer.setPixelRatio( window.devicePixelRatio );
								renderer.setSize( window.innerWidth, window.innerHeight );
								document.body.appendChild( renderer.domElement );
																	 
								renderer.shadowMap.enabled = true;
							}
						  </code>
						</pre>
					  </figure>
					<h3>
						<strong><u>Creating the Physics world</u></strong>
					</h3>
					<p>
						<strong>
							Now we create the physics world using Ammo.js. This is a separate world
							from the three.js world which has physics properties and will be the
							basis for what the objects we create in the three.js world is going to
							be doing in each frame.
						</strong>
					</p>
					<figure>
						<pre>
						  <code contenteditable spellcheck="false">  
							function setupPhysicsWorld()
							{
								let collisionConfiguration  = new Ammo.btDefaultCollisionConfiguration(),
									dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration),
									overlappingPairCache = new Ammo.btDbvtBroadphase(),
									solver = new Ammo.btSequentialImpulseConstraintSolver();
					
								physicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, overlappingPairCache, solver, collisionConfiguration);
								physicsWorld.setGravity(new Ammo.btVector3(0, -10, 0));
							}
						  </code>
						</pre>
					  </figure>
					<h3>
						<strong><u>Creating the render function</u></strong>
					</h3>
					<p>
						<strong>
							The next step is creating a render frame function, this function will
							create a render loop which for every frame the scene and camera are
							updated. However, you may notice that we only use the renderer in this
							loop meaning that we only render the three.js world without considering
							the ammo.js world. This is because at the minute there is no need to
							add physics to the three.js world. After all, there are currently no
							objects to apply physics to. We will cover this in the creating bodies
							part of this tutorial.
						</strong>
					</p>
					<figure>
						<pre>
						  <code contenteditable spellcheck="false">  
							function renderFrame()
							{
								renderer.render( scene, camera );
								requestAnimationFrame( renderFrame );
							}
						  </code>
						</pre>
					  </figure>
					<p>
						<strong>
							Now if you open the live server in vs code you should see just a blue
							screen this is good it means your code is working right now. The reason
							that there is nothing in it is that we have not added anything but the
							physics and the graphics world itself. If you don’t get a blue screen
							at this point like the image below there is an issue and you should go
							back and check your code.
						</strong>
					</p>
					<a href="#" class="image fit"><img src="images/blue screen.png" alt="" /></a>
					
				
				</div>
			</section>
	</body>
</html>